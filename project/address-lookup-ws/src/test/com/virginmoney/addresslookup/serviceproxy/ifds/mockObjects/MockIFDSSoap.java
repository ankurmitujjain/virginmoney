package com.virginmoney.addresslookup.serviceproxy.ifds.mockObjects;

import java.rmi.RemoteException;
import java.util.Map;
import java.util.HashMap;
import org.apache.log4j.Logger;
import org.apache.commons.lang.StringUtils;
import com.virginmoney.addresslookup.util.MarshalUtil;
import com.virginmoney.addresslookup.util.SchemaNotFoundException;
import uk.co.ifdsgroup.onlineservices.messages.getAddressReq.GetAddressReq;

/**
 * Mock implementation of the IFDS address  
 * @author woodsn
 *         <p/>
 *         Copyright     :  Virgin Money Ltd.
 */
public class MockIFDSSoap implements uk.co.ifdsgroup.onlineservices.messages.soap.OnlineServicesSoapHttpPort {

    private static Logger logger = Logger.getLogger(MockIFDSSoap.class);

    /**
     * A simple map which holds a search postcode and a result string.
     */
    private static Map<String,String> addressResponses = new HashMap<String,String>();

    // populate the addresses in the map
    static {

        // The key to the addressResponses object is postcode:building

        // postcode = NR4 6EJ
        addressResponses.put("NR46EJ:NULL","<?xml version=\"1.0\" encoding=\"UTF-8\"?><getAddress_Res><header><mc>000045</mc><source><systemInstance>33</systemInstance><subSystemInstance>0</subSystemInstance><requestUniqueID>0</requestUniqueID><responseUniqueID/></source><sessionID>0</sessionID></header><error><success>true</success></error><request><addressLine>null</addressLine><postCode>NR46EJ</postCode></request><response><addresses><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Virgin Money,Discovery House,4</addressLine></line><line><lineNo>2</lineNo><addressLine>Norwich Business Park</addressLine></line><line><lineNo>3</lineNo><addressLine>Whiting Road</addressLine></line><line><lineNo>4</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>5</lineNo><addressLine>Norfolk</addressLine></line></lines><postCode>NR4 6EJ</postCode></address></addressElements></addresses></response></getAddress_Res>");

        // postcode = NR14 8PA - mix of residential and business addresses, all with house names but no numbers
        addressResponses.put("NR148PA:NULL","<?xml version=\"1.0\" encoding=\"UTF-8\"?><getAddress_Res><header><mc>000045</mc><source><systemInstance>33</systemInstance><subSystemInstance>0</subSystemInstance><requestUniqueID>0</requestUniqueID><responseUniqueID/></source><sessionID>0</sessionID></header><error><success>true</success></error><request><addressLine/><postCode>NR14 8Pa</postCode></request><response><addresses><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Tas Valley House</addressLine></line><line><lineNo>2</lineNo><addressLine>Mill Road</addressLine></line><line><lineNo>3</lineNo><addressLine>Stoke Holy Cross</addressLine></line><line><lineNo>4</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>5</lineNo><addressLine>Norfolk</addressLine></line></lines><postCode>NR14 8PA</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Tara</addressLine></line><line><lineNo>2</lineNo><addressLine>Mill Road</addressLine></line><line><lineNo>3</lineNo><addressLine>Stoke Holy Cross</addressLine></line><line><lineNo>4</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>5</lineNo><addressLine>Norfolk</addressLine></line></lines><postCode>NR14 8PA</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Holy Cross Vicarage</addressLine></line><line><lineNo>2</lineNo><addressLine>Mill Road</addressLine></line><line><lineNo>3</lineNo><addressLine>Stoke Holy Cross</addressLine></line><line><lineNo>4</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>5</lineNo><addressLine>Norfolk</addressLine></line></lines><postCode>NR14 8PA</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Old Mill Restaurant</addressLine></line><line><lineNo>2</lineNo><addressLine>Mill Road</addressLine></line><line><lineNo>3</lineNo><addressLine>Stoke Holy Cross</addressLine></line><line><lineNo>4</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>5</lineNo><addressLine>Norfolk</addressLine></line></lines><postCode>NR14 8PA</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Netherfield</addressLine></line><line><lineNo>2</lineNo><addressLine>Mill Road</addressLine></line><line><lineNo>3</lineNo><addressLine>Stoke Holy Cross</addressLine></line><line><lineNo>4</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>5</lineNo><addressLine>Norfolk</addressLine></line></lines><postCode>NR14 8PA</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Jacama</addressLine></line><line><lineNo>2</lineNo><addressLine>Mill Road</addressLine></line><line><lineNo>3</lineNo><addressLine>Stoke Holy Cross</addressLine></line><line><lineNo>4</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>5</lineNo><addressLine>Norfolk</addressLine></line></lines><postCode>NR14 8PA</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Honeycombe</addressLine></line><line><lineNo>2</lineNo><addressLine>Mill Road</addressLine></line><line><lineNo>3</lineNo><addressLine>Stoke Holy Cross</addressLine></line><line><lineNo>4</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>5</lineNo><addressLine>Norfolk</addressLine></line></lines><postCode>NR14 8PA</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>High Beech House</addressLine></line><line><lineNo>2</lineNo><addressLine>Mill Road</addressLine></line><line><lineNo>3</lineNo><addressLine>Stoke Holy Cross</addressLine></line><line><lineNo>4</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>5</lineNo><addressLine>Norfolk</addressLine></line></lines><postCode>NR14 8PA</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Greenways</addressLine></line><line><lineNo>2</lineNo><addressLine>Mill Road</addressLine></line><line><lineNo>3</lineNo><addressLine>Stoke Holy Cross</addressLine></line><line><lineNo>4</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>5</lineNo><addressLine>Norfolk</addressLine></line></lines><postCode>NR14 8PA</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Torre</addressLine></line><line><lineNo>2</lineNo><addressLine>Mill Road</addressLine></line><line><lineNo>3</lineNo><addressLine>Stoke Holy Cross</addressLine></line><line><lineNo>4</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>5</lineNo><addressLine>Norfolk</addressLine></line></lines><postCode>NR14 8PA</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Dalriada</addressLine></line><line><lineNo>2</lineNo><addressLine>Mill Road</addressLine></line><line><lineNo>3</lineNo><addressLine>Stoke Holy Cross</addressLine></line><line><lineNo>4</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>5</lineNo><addressLine>Norfolk</addressLine></line></lines><postCode>NR14 8PA</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Craigley</addressLine></line><line><lineNo>2</lineNo><addressLine>Mill Road</addressLine></line><line><lineNo>3</lineNo><addressLine>Stoke Holy Cross</addressLine></line><line><lineNo>4</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>5</lineNo><addressLine>Norfolk</addressLine></line></lines><postCode>NR14 8PA</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Cordovan</addressLine></line><line><lineNo>2</lineNo><addressLine>Mill Road</addressLine></line><line><lineNo>3</lineNo><addressLine>Stoke Holy Cross</addressLine></line><line><lineNo>4</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>5</lineNo><addressLine>Norfolk</addressLine></line></lines><postCode>NR14 8PA</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Alveston</addressLine></line><line><lineNo>2</lineNo><addressLine>Mill Road</addressLine></line><line><lineNo>3</lineNo><addressLine>Stoke Holy Cross</addressLine></line><line><lineNo>4</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>5</lineNo><addressLine>Norfolk</addressLine></line></lines><postCode>NR14 8PA</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Mill Road Stores</addressLine></line><line><lineNo>2</lineNo><addressLine>Mill Road</addressLine></line><line><lineNo>3</lineNo><addressLine>Stoke Holy Cross</addressLine></line><line><lineNo>4</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>5</lineNo><addressLine>Norfolk</addressLine></line></lines><postCode>NR14 8PA</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Mill House</addressLine></line><line><lineNo>2</lineNo><addressLine>Mill Road</addressLine></line><line><lineNo>3</lineNo><addressLine>Stoke Holy Cross</addressLine></line><line><lineNo>4</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>5</lineNo><addressLine>Norfolk</addressLine></line></lines><postCode>NR14 8PA</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Stonecroft</addressLine></line><line><lineNo>2</lineNo><addressLine>Mill Road</addressLine></line><line><lineNo>3</lineNo><addressLine>Stoke Holy Cross</addressLine></line><line><lineNo>4</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>5</lineNo><addressLine>Norfolk</addressLine></line></lines><postCode>NR14 8PA</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Purbeck Cottage</addressLine></line><line><lineNo>2</lineNo><addressLine>Mill Road</addressLine></line><line><lineNo>3</lineNo><addressLine>Stoke Holy Cross</addressLine></line><line><lineNo>4</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>5</lineNo><addressLine>Norfolk</addressLine></line></lines><postCode>NR14 8PA</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Dovedale</addressLine></line><line><lineNo>2</lineNo><addressLine>Mill Road</addressLine></line><line><lineNo>3</lineNo><addressLine>Stoke Holy Cross</addressLine></line><line><lineNo>4</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>5</lineNo><addressLine>Norfolk</addressLine></line></lines><postCode>NR14 8PA</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Low Meadow</addressLine></line><line><lineNo>2</lineNo><addressLine>Mill Road</addressLine></line><line><lineNo>3</lineNo><addressLine>Stoke Holy Cross</addressLine></line><line><lineNo>4</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>5</lineNo><addressLine>Norfolk</addressLine></line></lines><postCode>NR14 8PA</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Post Office</addressLine></line><line><lineNo>2</lineNo><addressLine>Mill Road</addressLine></line><line><lineNo>3</lineNo><addressLine>Stoke Holy Cross</addressLine></line><line><lineNo>4</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>5</lineNo><addressLine>Norfolk</addressLine></line></lines><postCode>NR14 8PA</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>The Enchanted Rose</addressLine></line><line><lineNo>2</lineNo><addressLine>Mill Road</addressLine></line><line><lineNo>3</lineNo><addressLine>Stoke Holy Cross</addressLine></line><line><lineNo>4</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>5</lineNo><addressLine>Norfolk</addressLine></line></lines><postCode>NR14 8PA</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Mill Cottage</addressLine></line><line><lineNo>2</lineNo><addressLine>Mill Road</addressLine></line><line><lineNo>3</lineNo><addressLine>Stoke Holy Cross</addressLine></line><line><lineNo>4</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>5</lineNo><addressLine>Norfolk</addressLine></line></lines><postCode>NR14 8PA</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>The Blue Barn</addressLine></line><line><lineNo>2</lineNo><addressLine>Mill Road</addressLine></line><line><lineNo>3</lineNo><addressLine>Stoke Holy Cross</addressLine></line><line><lineNo>4</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>5</lineNo><addressLine>Norfolk</addressLine></line></lines><postCode>NR14 8PA</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>A R B G Dive Supplies,The Workshops,Mill House</addressLine></line><line><lineNo>2</lineNo><addressLine>Mill Road</addressLine></line><line><lineNo>3</lineNo><addressLine>Stoke Holy Cross</addressLine></line><line><lineNo>4</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>5</lineNo><addressLine>Norfolk</addressLine></line></lines><postCode>NR14 8PA</postCode></address></addressElements></addresses></response></getAddress_Res>");

        // postcode = NR14 8PA - single result for one building
        addressResponses.put("NR148PA:HONEYCOMBE","<?xml version=\"1.0\" encoding=\"UTF-8\"?><getAddress_Res><header><mc>000045</mc><source><systemInstance>33</systemInstance><subSystemInstance>0</subSystemInstance><requestUniqueID>0</requestUniqueID><responseUniqueID/></source><sessionID>0</sessionID></header><error><success>true</success></error><request><addressLine/><postCode>NR14 8Pa</postCode></request><response><addresses><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Honeycombe</addressLine></line><line><lineNo>2</lineNo><addressLine>Mill Road</addressLine></line><line><lineNo>3</lineNo><addressLine>Stoke Holy Cross</addressLine></line><line><lineNo>4</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>5</lineNo><addressLine>Norfolk</addressLine></line></lines><postCode>NR14 8PA</postCode></address></addressElements></addresses></response></getAddress_Res>");

        // postcode = NR14 8PA  - single result for one building
        addressResponses.put("NR148PA:GREENWAYS","<?xml version=\"1.0\" encoding=\"UTF-8\"?><getAddress_Res><header><mc>000045</mc><source><systemInstance>33</systemInstance><subSystemInstance>0</subSystemInstance><requestUniqueID>0</requestUniqueID><responseUniqueID/></source><sessionID>0</sessionID></header><error><success>true</success></error><request><addressLine/><postCode>NR14 8Pa</postCode></request><response><addresses><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Greenways</addressLine></line><line><lineNo>2</lineNo><addressLine>Mill Road</addressLine></line><line><lineNo>3</lineNo><addressLine>Stoke Holy Cross</addressLine></line><line><lineNo>4</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>5</lineNo><addressLine>Norfolk</addressLine></line></lines><postCode>NR14 8PA</postCode></address></addressElements></addresses></response></getAddress_Res>");

        // postcode = NR8 6BD all residential, all numbered
        addressResponses.put("NR86BD:NULL","<?xml version=\"1.0\" encoding=\"UTF-8\"?><getAddress_Res><header><mc>000045</mc><source><systemInstance>33</systemInstance><subSystemInstance>0</subSystemInstance><requestUniqueID>0</requestUniqueID><responseUniqueID/></source><sessionID>0</sessionID></header><error><success>true</success></error><request><addressLine>null</addressLine><postCode>NR86BD</postCode></request><response><addresses><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>109 Drayton High Road</addressLine></line><line><lineNo>2</lineNo><addressLine>Drayton</addressLine></line><line><lineNo>3</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>4</lineNo><addressLine>Norfolk</addressLine></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>NR8 6BD</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>111 Drayton High Road</addressLine></line><line><lineNo>2</lineNo><addressLine>Drayton</addressLine></line><line><lineNo>3</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>4</lineNo><addressLine>Norfolk</addressLine></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>NR8 6BD</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>113 Drayton High Road</addressLine></line><line><lineNo>2</lineNo><addressLine>Drayton</addressLine></line><line><lineNo>3</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>4</lineNo><addressLine>Norfolk</addressLine></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>NR8 6BD</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>115 Drayton High Road</addressLine></line><line><lineNo>2</lineNo><addressLine>Drayton</addressLine></line><line><lineNo>3</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>4</lineNo><addressLine>Norfolk</addressLine></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>NR8 6BD</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>117 Drayton High Road</addressLine></line><line><lineNo>2</lineNo><addressLine>Drayton</addressLine></line><line><lineNo>3</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>4</lineNo><addressLine>Norfolk</addressLine></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>NR8 6BD</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>119 Drayton High Road</addressLine></line><line><lineNo>2</lineNo><addressLine>Drayton</addressLine></line><line><lineNo>3</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>4</lineNo><addressLine>Norfolk</addressLine></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>NR8 6BD</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>121 Drayton High Road</addressLine></line><line><lineNo>2</lineNo><addressLine>Drayton</addressLine></line><line><lineNo>3</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>4</lineNo><addressLine>Norfolk</addressLine></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>NR8 6BD</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>123 Drayton High Road</addressLine></line><line><lineNo>2</lineNo><addressLine>Drayton</addressLine></line><line><lineNo>3</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>4</lineNo><addressLine>Norfolk</addressLine></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>NR8 6BD</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>125 Drayton High Road</addressLine></line><line><lineNo>2</lineNo><addressLine>Drayton</addressLine></line><line><lineNo>3</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>4</lineNo><addressLine>Norfolk</addressLine></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>NR8 6BD</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>127 Drayton High Road</addressLine></line><line><lineNo>2</lineNo><addressLine>Drayton</addressLine></line><line><lineNo>3</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>4</lineNo><addressLine>Norfolk</addressLine></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>NR8 6BD</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>129 Drayton High Road</addressLine></line><line><lineNo>2</lineNo><addressLine>Drayton</addressLine></line><line><lineNo>3</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>4</lineNo><addressLine>Norfolk</addressLine></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>NR8 6BD</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>131 Drayton High Road</addressLine></line><line><lineNo>2</lineNo><addressLine>Drayton</addressLine></line><line><lineNo>3</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>4</lineNo><addressLine>Norfolk</addressLine></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>NR8 6BD</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>133 Drayton High Road</addressLine></line><line><lineNo>2</lineNo><addressLine>Drayton</addressLine></line><line><lineNo>3</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>4</lineNo><addressLine>Norfolk</addressLine></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>NR8 6BD</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>135 Drayton High Road</addressLine></line><line><lineNo>2</lineNo><addressLine>Drayton</addressLine></line><line><lineNo>3</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>4</lineNo><addressLine>Norfolk</addressLine></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>NR8 6BD</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>137 Drayton High Road</addressLine></line><line><lineNo>2</lineNo><addressLine>Drayton</addressLine></line><line><lineNo>3</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>4</lineNo><addressLine>Norfolk</addressLine></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>NR8 6BD</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>139 Drayton High Road</addressLine></line><line><lineNo>2</lineNo><addressLine>Drayton</addressLine></line><line><lineNo>3</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>4</lineNo><addressLine>Norfolk</addressLine></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>NR8 6BD</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>141 Drayton High Road</addressLine></line><line><lineNo>2</lineNo><addressLine>Drayton</addressLine></line><line><lineNo>3</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>4</lineNo><addressLine>Norfolk</addressLine></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>NR8 6BD</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>143 Drayton High Road</addressLine></line><line><lineNo>2</lineNo><addressLine>Drayton</addressLine></line><line><lineNo>3</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>4</lineNo><addressLine>Norfolk</addressLine></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>NR8 6BD</postCode></address></addressElements></addresses></response></getAddress_Res>");

        // postcode = NR8 6BD  - single result for one building
        addressResponses.put("NR86BD:113","<?xml version=\"1.0\" encoding=\"UTF-8\"?><getAddress_Res><header><mc>000045</mc><source><systemInstance>33</systemInstance><subSystemInstance>0</subSystemInstance><requestUniqueID>0</requestUniqueID><responseUniqueID/></source><sessionID>0</sessionID></header><error><success>true</success></error><request><addressLine>null</addressLine><postCode>NR86BD</postCode></request><response><addresses><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>113 Drayton High Road</addressLine></line><line><lineNo>2</lineNo><addressLine>Drayton</addressLine></line><line><lineNo>3</lineNo><addressLine>Norwich</addressLine></line><line><lineNo>4</lineNo><addressLine>Norfolk</addressLine></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>NR8 6BD</postCode></address></addressElements></addresses></response></getAddress_Res>");


        // N10 3EL has flat numbers
        addressResponses.put("N103EL:NULL","<?xml version=\"1.0\" encoding=\"UTF-8\"?><getAddress_Res><header><mc>000045</mc><source><systemInstance>33</systemInstance><subSystemInstance>0</subSystemInstance><requestUniqueID>0</requestUniqueID><responseUniqueID/></source><sessionID>0</sessionID></header><error><success>true</success></error><request><addressLine>null</addressLine><postCode>N103EL</postCode></request><response><addresses><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Flat 1,Midhurst Mansions</addressLine></line><line><lineNo>2</lineNo><addressLine>Fortis Green</addressLine></line><line><lineNo>3</lineNo><addressLine>London</addressLine></line><line><lineNo>4</lineNo><addressLine/></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>N10 3EL</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Flat 2,Midhurst Mansions</addressLine></line><line><lineNo>2</lineNo><addressLine>Fortis Green</addressLine></line><line><lineNo>3</lineNo><addressLine>London</addressLine></line><line><lineNo>4</lineNo><addressLine/></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>N10 3EL</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Flat 3,Midhurst Mansions</addressLine></line><line><lineNo>2</lineNo><addressLine>Fortis Green</addressLine></line><line><lineNo>3</lineNo><addressLine>London</addressLine></line><line><lineNo>4</lineNo><addressLine/></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>N10 3EL</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Flat 4,Midhurst Mansions</addressLine></line><line><lineNo>2</lineNo><addressLine>Fortis Green</addressLine></line><line><lineNo>3</lineNo><addressLine>London</addressLine></line><line><lineNo>4</lineNo><addressLine/></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>N10 3EL</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Flat 5,Midhurst Mansions</addressLine></line><line><lineNo>2</lineNo><addressLine>Fortis Green</addressLine></line><line><lineNo>3</lineNo><addressLine>London</addressLine></line><line><lineNo>4</lineNo><addressLine/></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>N10 3EL</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Flat 6,Midhurst Mansions</addressLine></line><line><lineNo>2</lineNo><addressLine>Fortis Green</addressLine></line><line><lineNo>3</lineNo><addressLine>London</addressLine></line><line><lineNo>4</lineNo><addressLine/></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>N10 3EL</postCode></address></addressElements></addresses></response></getAddress_Res>");
        // N10 3EL has flat numbers
        addressResponses.put("N120DT:NULL","<?xml version=\"1.0\" encoding=\"UTF-8\"?><getAddress_Res><header><mc>000045</mc><source><systemInstance>33</systemInstance><subSystemInstance>0</subSystemInstance><requestUniqueID>0</requestUniqueID><responseUniqueID/></source><sessionID>0</sessionID></header><error><success>true</success></error><request><addressLine>null</addressLine><postCode>N120DT</postCode></request><response><addresses><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Flat 1,Colman Court</addressLine></line><line><lineNo>2</lineNo><addressLine>Christchurch Avenue</addressLine></line><line><lineNo>3</lineNo><addressLine>London</addressLine></line><line><lineNo>4</lineNo><addressLine/></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>N12 0DT</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Flat 2,Colman Court</addressLine></line><line><lineNo>2</lineNo><addressLine>Christchurch Avenue</addressLine></line><line><lineNo>3</lineNo><addressLine>London</addressLine></line><line><lineNo>4</lineNo><addressLine/></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>N12 0DT</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Flat 3,Colman Court</addressLine></line><line><lineNo>2</lineNo><addressLine>Christchurch Avenue</addressLine></line><line><lineNo>3</lineNo><addressLine>London</addressLine></line><line><lineNo>4</lineNo><addressLine/></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>N12 0DT</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Flat 4,Colman Court</addressLine></line><line><lineNo>2</lineNo><addressLine>Christchurch Avenue</addressLine></line><line><lineNo>3</lineNo><addressLine>London</addressLine></line><line><lineNo>4</lineNo><addressLine/></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>N12 0DT</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Flat 5,Colman Court</addressLine></line><line><lineNo>2</lineNo><addressLine>Christchurch Avenue</addressLine></line><line><lineNo>3</lineNo><addressLine>London</addressLine></line><line><lineNo>4</lineNo><addressLine/></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>N12 0DT</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Flat 6,Colman Court</addressLine></line><line><lineNo>2</lineNo><addressLine>Christchurch Avenue</addressLine></line><line><lineNo>3</lineNo><addressLine>London</addressLine></line><line><lineNo>4</lineNo><addressLine/></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>N12 0DT</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Flat 7,Colman Court</addressLine></line><line><lineNo>2</lineNo><addressLine>Christchurch Avenue</addressLine></line><line><lineNo>3</lineNo><addressLine>London</addressLine></line><line><lineNo>4</lineNo><addressLine/></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>N12 0DT</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Flat 8,Colman Court</addressLine></line><line><lineNo>2</lineNo><addressLine>Christchurch Avenue</addressLine></line><line><lineNo>3</lineNo><addressLine>London</addressLine></line><line><lineNo>4</lineNo><addressLine/></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>N12 0DT</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Flat 9,Colman Court</addressLine></line><line><lineNo>2</lineNo><addressLine>Christchurch Avenue</addressLine></line><line><lineNo>3</lineNo><addressLine>London</addressLine></line><line><lineNo>4</lineNo><addressLine/></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>N12 0DT</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Flat 10,Colman Court</addressLine></line><line><lineNo>2</lineNo><addressLine>Christchurch Avenue</addressLine></line><line><lineNo>3</lineNo><addressLine>London</addressLine></line><line><lineNo>4</lineNo><addressLine/></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>N12 0DT</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Flat 11,Colman Court</addressLine></line><line><lineNo>2</lineNo><addressLine>Christchurch Avenue</addressLine></line><line><lineNo>3</lineNo><addressLine>London</addressLine></line><line><lineNo>4</lineNo><addressLine/></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>N12 0DT</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Flat 12,Colman Court</addressLine></line><line><lineNo>2</lineNo><addressLine>Christchurch Avenue</addressLine></line><line><lineNo>3</lineNo><addressLine>London</addressLine></line><line><lineNo>4</lineNo><addressLine/></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>N12 0DT</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Flat 13,Colman Court</addressLine></line><line><lineNo>2</lineNo><addressLine>Christchurch Avenue</addressLine></line><line><lineNo>3</lineNo><addressLine>London</addressLine></line><line><lineNo>4</lineNo><addressLine/></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>N12 0DT</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Flat 14,Colman Court</addressLine></line><line><lineNo>2</lineNo><addressLine>Christchurch Avenue</addressLine></line><line><lineNo>3</lineNo><addressLine>London</addressLine></line><line><lineNo>4</lineNo><addressLine/></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>N12 0DT</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Flat 15,Colman Court</addressLine></line><line><lineNo>2</lineNo><addressLine>Christchurch Avenue</addressLine></line><line><lineNo>3</lineNo><addressLine>London</addressLine></line><line><lineNo>4</lineNo><addressLine/></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>N12 0DT</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Flat 16,Colman Court</addressLine></line><line><lineNo>2</lineNo><addressLine>Christchurch Avenue</addressLine></line><line><lineNo>3</lineNo><addressLine>London</addressLine></line><line><lineNo>4</lineNo><addressLine/></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>N12 0DT</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Flat 17,Colman Court</addressLine></line><line><lineNo>2</lineNo><addressLine>Christchurch Avenue</addressLine></line><line><lineNo>3</lineNo><addressLine>London</addressLine></line><line><lineNo>4</lineNo><addressLine/></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>N12 0DT</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Flat 18,Colman Court</addressLine></line><line><lineNo>2</lineNo><addressLine>Christchurch Avenue</addressLine></line><line><lineNo>3</lineNo><addressLine>London</addressLine></line><line><lineNo>4</lineNo><addressLine/></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>N12 0DT</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Flat 19,Colman Court</addressLine></line><line><lineNo>2</lineNo><addressLine>Christchurch Avenue</addressLine></line><line><lineNo>3</lineNo><addressLine>London</addressLine></line><line><lineNo>4</lineNo><addressLine/></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>N12 0DT</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Flat 20,Colman Court</addressLine></line><line><lineNo>2</lineNo><addressLine>Christchurch Avenue</addressLine></line><line><lineNo>3</lineNo><addressLine>London</addressLine></line><line><lineNo>4</lineNo><addressLine/></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>N12 0DT</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Flat 21,Colman Court</addressLine></line><line><lineNo>2</lineNo><addressLine>Christchurch Avenue</addressLine></line><line><lineNo>3</lineNo><addressLine>London</addressLine></line><line><lineNo>4</lineNo><addressLine/></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>N12 0DT</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Flat 22,Colman Court</addressLine></line><line><lineNo>2</lineNo><addressLine>Christchurch Avenue</addressLine></line><line><lineNo>3</lineNo><addressLine>London</addressLine></line><line><lineNo>4</lineNo><addressLine/></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>N12 0DT</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Flat 23,Colman Court</addressLine></line><line><lineNo>2</lineNo><addressLine>Christchurch Avenue</addressLine></line><line><lineNo>3</lineNo><addressLine>London</addressLine></line><line><lineNo>4</lineNo><addressLine/></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>N12 0DT</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Flat 24,Colman Court</addressLine></line><line><lineNo>2</lineNo><addressLine>Christchurch Avenue</addressLine></line><line><lineNo>3</lineNo><addressLine>London</addressLine></line><line><lineNo>4</lineNo><addressLine/></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>N12 0DT</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Flat 25,Colman Court</addressLine></line><line><lineNo>2</lineNo><addressLine>Christchurch Avenue</addressLine></line><line><lineNo>3</lineNo><addressLine>London</addressLine></line><line><lineNo>4</lineNo><addressLine/></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>N12 0DT</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Flat 26,Colman Court</addressLine></line><line><lineNo>2</lineNo><addressLine>Christchurch Avenue</addressLine></line><line><lineNo>3</lineNo><addressLine>London</addressLine></line><line><lineNo>4</lineNo><addressLine/></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>N12 0DT</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Flat 27,Colman Court</addressLine></line><line><lineNo>2</lineNo><addressLine>Christchurch Avenue</addressLine></line><line><lineNo>3</lineNo><addressLine>London</addressLine></line><line><lineNo>4</lineNo><addressLine/></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>N12 0DT</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Flat 28,Colman Court</addressLine></line><line><lineNo>2</lineNo><addressLine>Christchurch Avenue</addressLine></line><line><lineNo>3</lineNo><addressLine>London</addressLine></line><line><lineNo>4</lineNo><addressLine/></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>N12 0DT</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Flat 29,Colman Court</addressLine></line><line><lineNo>2</lineNo><addressLine>Christchurch Avenue</addressLine></line><line><lineNo>3</lineNo><addressLine>London</addressLine></line><line><lineNo>4</lineNo><addressLine/></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>N12 0DT</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Flat 30,Colman Court</addressLine></line><line><lineNo>2</lineNo><addressLine>Christchurch Avenue</addressLine></line><line><lineNo>3</lineNo><addressLine>London</addressLine></line><line><lineNo>4</lineNo><addressLine/></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>N12 0DT</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Flat 31,Colman Court</addressLine></line><line><lineNo>2</lineNo><addressLine>Christchurch Avenue</addressLine></line><line><lineNo>3</lineNo><addressLine>London</addressLine></line><line><lineNo>4</lineNo><addressLine/></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>N12 0DT</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Flat 32,Colman Court</addressLine></line><line><lineNo>2</lineNo><addressLine>Christchurch Avenue</addressLine></line><line><lineNo>3</lineNo><addressLine>London</addressLine></line><line><lineNo>4</lineNo><addressLine/></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>N12 0DT</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Flat 33,Colman Court</addressLine></line><line><lineNo>2</lineNo><addressLine>Christchurch Avenue</addressLine></line><line><lineNo>3</lineNo><addressLine>London</addressLine></line><line><lineNo>4</lineNo><addressLine/></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>N12 0DT</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Flat 34,Colman Court</addressLine></line><line><lineNo>2</lineNo><addressLine>Christchurch Avenue</addressLine></line><line><lineNo>3</lineNo><addressLine>London</addressLine></line><line><lineNo>4</lineNo><addressLine/></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>N12 0DT</postCode></address></addressElements><addressElements><addressKind>unknown</addressKind><address><lines><line><lineNo>1</lineNo><addressLine>Flat 35,Colman Court</addressLine></line><line><lineNo>2</lineNo><addressLine>Christchurch Avenue</addressLine></line><line><lineNo>3</lineNo><addressLine>London</addressLine></line><line><lineNo>4</lineNo><addressLine/></line><line><lineNo>5</lineNo><addressLine/></line></lines><postCode>N12 0DT</postCode></address></addressElements></addresses></response></getAddress_Res>");

        // null result for when nothing can be found
        addressResponses.put("NULL","<?xml version=\"1.0\" encoding=\"UTF-8\"?><getAddress_Res><header><mc>000045</mc><source><systemInstance>33</systemInstance><subSystemInstance>0</subSystemInstance><requestUniqueID>0</requestUniqueID><responseUniqueID/></source><sessionID>0</sessionID></header><error><anError><errorCode>136</errorCode><errorText>Postcode had no matching addresses</errorText><errorDomain>0</errorDomain></anError><success>false</success></error><request><addressLine>null</addressLine><postCode>XX999XX</postCode></request><response><addresses/></response></getAddress_Res>");

    }

    /**
     * Mock implementation of the getAddress call, uses a predefined list of postcodes to return a result.
     * For a list of supported postcodes and building names see the static code which populates addressResponses
     * @param xmlRequest
     * @return
     * @throws RemoteException
     */
    public String getAddress(String xmlRequest) throws RemoteException {

        logger.debug("MOCK getAddress processing request " + xmlRequest);

        // Because the input postcode is contained within the XML request string, we need to marshall it into
        // message objects to extract the value.
        GetAddressReq request;

        try {
        request = (GetAddressReq) MarshalUtil.unmarshal(xmlRequest,GetAddressReq.class);
        }
        catch (SchemaNotFoundException e) {
            logger.error ("MOCK getAddress caught " + e);
            return null;
        }
        catch (Exception e) {
            logger.error ("MOCK getAddress caught " + e);
            return null;
        }

        String postcode = request.getRequest().getPostCode();
        String building = request.getRequest().getAddressLine();
        logger.debug("MOCK getAddress processing searching for postcode=" + postcode + " and building=" + building);

        // Now we have the postcode we can use it to extract the correct response from the Map
        String xmlResponse;
        String searchPostcode = (StringUtils.isBlank(postcode) ? "NULL": StringUtils.replace(postcode.toUpperCase()," ",""));
        String searchBuilding = (StringUtils.isBlank(building) ? "NULL": StringUtils.replace(building.toUpperCase()," ",""));

        logger.debug("MOCK getAddress looking for search postcode=\"" + searchPostcode + "\" and building=\"" + searchBuilding + "\"");

        xmlResponse = addressResponses.get(searchPostcode + ":" + searchBuilding);

        // If we found nothing,
        if (StringUtils.isBlank(xmlResponse)) {
            // no data found, so re-query using the null response.
            xmlResponse = addressResponses.get("NULL");
            logger.debug("MOCK fastAddress looking for NULL response ");
             if (xmlResponse == null) {
                 logger.debug("MOCK fastAddress found nothing ");
                 return null;
             }
        }

        logger.debug("MOCK getAddress found xmlResponse=\n" + xmlResponse);

        return xmlResponse;
    }
}
